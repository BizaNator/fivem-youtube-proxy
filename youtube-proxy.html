<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>Video Player</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; background: #000; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>
    <iframe
        id="player"
        referrerpolicy="strict-origin-when-cross-origin"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
    </iframe>
    <script>
        (function() {
            const params = new URLSearchParams(window.location.search);
            const videoId = params.get('v');
            const playlistId = params.get('list');

            if (!videoId && !playlistId) {
                document.body.innerHTML = '<p style="color:#fff;text-align:center;padding:20px;">No video specified. Use ?v=VIDEO_ID or ?list=PLAYLIST_ID</p>';
                return;
            }

            // Build YouTube embed URL
            const embedParams = new URLSearchParams({
                autoplay: params.get('autoplay') || '1',
                mute: params.get('mute') || '1',
                controls: params.get('controls') || '0',
                loop: params.get('loop') || '1',
                rel: '0',
                modestbranding: '1',
                playsinline: '1',
                enablejsapi: '1',
                origin: window.location.origin
            });

            let embedUrl;
            if (playlistId) {
                embedParams.set('list', playlistId);
                embedParams.set('listType', 'playlist');
                if (params.get('index')) {
                    embedParams.set('index', params.get('index'));
                }
                // Use videoseries for playlist, or specific video + playlist
                if (videoId) {
                    embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}?${embedParams.toString()}`;
                } else {
                    embedUrl = `https://www.youtube-nocookie.com/embed/videoseries?${embedParams.toString()}`;
                }
            } else {
                // For single video looping, playlist param must equal video ID
                embedParams.set('playlist', videoId);
                embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}?${embedParams.toString()}`;
            }

            document.getElementById('player').src = embedUrl;
        })();
    </script>
</body>
</html>
